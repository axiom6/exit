
# Design

# HTML

## App.html

* Loads all CSS and Fonts by link tags
* Loads all third party JavaScript from Bower repositories by script tags
* Loads all Exit Now JavaScript source code (21 files) by script tags
* Has only a body with an App div tag. All other HTML is generated by CoffeeScript

## Third Party CSS, Icons and Fonts from Bower repository

* app.gritter.css for popup deals. Refactored from original griiter.css for embedded HTML
* Font Awesome Icons
* Weather Icons
* Droid Sans
* Open Sans Condensed

# App.less / css

* The primary CSS at about a hundred lines
* Makes judicious use of absolute postioning in percentages
* Naming convention has a direct correspondence to UI components 


# JavaScript Source Code Design and Organization 

The 21 files of JavaScript are organized into two categories App and UI with two folders /app /ui

## /app 9 files

### App.coffee

#### Primary Responsibilities

  - Imports all classes into its namespace
  - Instanciates all objects and injects itself, Stream and dependencies via constructor arguments
  - Issues ready() calls to all UI object to generation the HTML
  - Issues position() for additional positioning after HTML generations
  
#### Secondary Responsibilities
 
  - Instanciated by onReady status
  - Maintains destination, direction, eta and recommentation status
  - Governs the running of demos, rest, retries, simulations and tests specied by arguments passed into its constructor
  
### Stream.coffee

* Wraps RxJS with 

### Rest.coffee

* xx
* Pipes all GETs though a single jQuery.ajax( setting ) method
* In retry 

### Data.coffee

* Static JavaScript objects for demos and repeatable unit testing data sets

### Model.coffee

* Manages all Rest calls
* Handles the combine completion status of simutaneous GET queries
* Delays pushing Stream publishing until all GETs  are complete 

### Simulate.coffee

  - Simulates I-70 drives by publishing at series of cell phone lat lon location 
  
### Test

  - Runs unit tests in Jasmine
  
### Util.coffee
 
  - A set of static class methods for class export and import and logging
  - Accessed via a Util global variable 
  
* Visual.coffee
* 
  - A set of static class methods for D3 visualization
  - Accessed via a Visual global variable 

## /ui 12 files Classes correspond to Pages

### Aggregate Pages

* UI.coffee   with Desitination Go, NoGo Trip, Deals and Navigate pages
* Trip.coffee with Road Weather and Advisory components 

### Single Pages 
* Destination
* Go
* NoGo
* Trip
* Deals
* Navigate - not imlemented yet

### Page Components
* Road with Drive Bar
* Weather
* Advisory - not implemented yet
* Threshold - not implement yet 

### Canonical Methods for UI Pages classes
- constructor:( args... ) 
- ready:() 
- postReady:()
- layout:( orientation )
- show:()
- hide:()
- publish:()
- subscript:()
# Design Decision Rationale

## RxJs over MVC Rationale

We chose RxJs over MVC for the following reasons

* Notification Driven Requirements
* The RxJs interface is lightweigtht and non-intrusive
  - All of RxJs is contained in the Stream class
  - The only methods the other classes access are publish(), subscribe and push()
* Message driven publish and subscript

## CoffeeScript

* A transpiler to JavaScript
* Creates beautiful JavaScript prototype object from class definition
* String interpolation #{} for HTML templates

# Less

* Adds macros to CSS



## Notification Stream

The notification stream is categorized by the following subjects:

* Select
* Orient
* Destination
* ETA
* Location
* TakeDeal
* ArriveAtDeal
* Segments
* Deals
* Conditions
* RequestSegmentsBy
* RequestConditionsBy
* RequestDealsBy





                           'Segments','Deals','Conditions',
                           'RequestSegmentBy','RequestConditionsBy','RequestDealsBy']


## Dependencies
* jQuery
* jQuery.gritter
* rxjs
* rxjs-jquery
* d3
* font-awesome
* weather-icons

# Dev Dependencies
* coffeescript
* less
* jasmine


 @tom.flaherty: right now I think quality is our biggest concern.  specifically "Score in this category concerns the workability of the app as-is and how much of the app will have to be re-written or fixed later. Judges should reflect on the overall architecture and infrastructure of the app, static analysis, and coding language standards."
Given what everyone is currently focused on, I think it would be best if you could stay with the app...anything to clean up the code, add comments, put together documentation/wiki/etc. would be the most bang-for-the-buck that you could do.  Quality represents the single most important factor and it's also our weakest piece at this point. 

Good advice. Code cleanup is in a nice place. The Stream Notification architecture is great and easy to explain from a Publish / Subscribe context. CoffeeScript with OO classes improves JavaScript coding standards by an order of magnitude by encapsulating methods but not state. Future CSS refactoring is facilitated by keeping App.less/css at a hundred line of code. So get the picture. 

The weak areas are a flat screen design, screen navigation, usability and the demonstration of real drive scenarios. Areas where the code is provisioned to built out upon. UI interaction scenarios require the most time, thought and iteration. Our minimal approach of Destination, Go NoGo and Deal screens started out good but constrained the current App from effectively dealing with the real world while driving and triggers which is the cornerstone of my testing. So doing writing these replies and doing the Doc helps me truly understand the App from an outside perspective to prioritize what can be fixed for now.
daniel 1:38 PM